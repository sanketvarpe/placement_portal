
> db.createCollection('student')
{ "ok" : 1 }


> db.student.insertMany([  {roll: 1, name: 'sanket', marks: [25, 27, 28, 25, 23]}, {roll: 2, name: 'sojas', marks: [23, 24, 24, 28, 24]}, {roll: 3, name: 'ketan', marks: [25, 26, 27, 23, 21]}, {roll: 4, name: 'nilesh', marks: [24, 23, 22, 20, 27]} ]);
{
        "acknowledged" : true,
        "insertedIds" : [
                ObjectId("5fa1240bff231d2ca914391f"),
                ObjectId("5fa1240bff231d2ca9143920"),
                ObjectId("5fa1240bff231d2ca9143921"),
                ObjectId("5fa1240bff231d2ca9143922")
        ]
}


> db.student.find().pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365d"),
        "roll" : 1,
        "name" : "sanket",
        "marks" : [
                25,
                27,
                28,
                25,
                23
        ]
}
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365e"),
        "roll" : 2,
        "name" : "sojas",
        "marks" : [
                23,
                24,
                24,
                28,
                24
        ]
}
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365f"),
        "roll" : 3,
        "name" : "ketan",
        "marks" : [
                25,
                26,
                27,
                23,
                21
        ]
}
{
        "_id" : ObjectId("5faa0aff89ebda69fca63660"),
        "roll" : 4,
        "name" : "nilesh",
        "marks" : [
                24,
                23,
                22,
                20,
                27
        ]
}


// update array elements
1) $ operator

> db.student.updateOne({roll: 1, marks: 23}, {$set: {"marks.$": 20}});
{ "acknowledged" : true, "matchedCount" : 1, "modifiedCount" : 1 }

> db.student.find({roll: 1}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365d"),
        "roll" : 1,
        "name" : "sanket",
        "marks" : [
                25,
                27,
                28,
                25,
                20
        ]
}


2) $[] operators

> db.student.update({roll: 3}, {$inc: {"marks.$[]": -3}});
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 3}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365f"),
        "roll" : 3,
        "name" : "ketan",
        "marks" : [
                22,
                23,
                24,
                20,
                18
        ]
}


3) $[<identifier>] operator

> db.student.update({roll: 1}, {$set: {"marks.$[element]": 25}}, {arrayFilters: [{"element": {$gte: 25}}]})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 1}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365d"),
        "roll" : 1,
        "name" : "sanket",
        "marks" : [
                25,
                25,
                25,
                25,
                20
        ]
}


// $addToSet

> db.student.update({roll: 4}, {$addToSet: {marks: 30}})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 4}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca63660"),
        "roll" : 4,
        "name" : "nilesh",
        "marks" : [
                24,
                23,
                22,
                20,
                27,
                30
        ]
}


// $pop

> db.student.update({roll: 4}, {$pop: {marks: -1}})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 4}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca63660"),
        "roll" : 4,
        "name" : "nilesh",
        "marks" : [
		23
                22,
                20,
                27,
                30
        ]
}

> db.student.update({roll: 4}, {$pop: {marks: 1}})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 4}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca63660"),
        "roll" : 4,
        "name" : "nilesh",
        "marks" : [
                22,
                20,
                27
        ]
}


// $pull

> db.student.update({roll: 1}, {$pull: {marks: 25}})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 1}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365d"),
        "roll" : 1,
        "name" : "sanket",
        "marks" : [
                20
        ]
}


// $push
1) Push single value

> db.student.update({roll: 1}, {$push: {marks: 28}})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 1}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365d"),
        "roll" : 1,
        "name" : "sanket",
        "marks" : [
                20,
                28
        ]
}

2) Push multiple values

> db.student.update({roll: 1}, {$push: {marks: {$each: [24, 23, 25]}}})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 1}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365d"),
        "roll" : 1,
        "name" : "sanket",
        "marks" : [
                20,
                28,
                24,
                23,
                25
        ]
}

// $pullAll

> db.student.update({roll: 3}, {$pullAll: {marks: [22, 23, 24]}})
WriteResult({ "nMatched" : 1, "nUpserted" : 0, "nModified" : 1 })

> db.student.find({roll: 3}).pretty()
{
        "_id" : ObjectId("5faa0aff89ebda69fca6365f"),
        "roll" : 3,
        "name" : "ketan",
        "marks" : [
                20,
                18
        ]
}

