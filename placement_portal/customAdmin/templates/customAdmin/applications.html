{% extends 'accounts/base.html' %}
{%block title%}Dashboard{%endblock title%}
{% block styles %}
<style>

</style>
{% endblock styles%}
{% block content %}
<div class="table-responsive">
    <div class="display-4 border-bottom mx-1">
        Applications
    </div>
    <div>
    <table class="table table-sm table-bordered table-light mt-5">
        <thead class="thead-dark">
            <tr>
                <th>Application Id</th>
                <th>Registration ID</th>
                <th>Name</th>
                <th>Application status</th>
            </tr>
        </thead>
        <tbody>
            {% for app in page_obj %}
            <tr>
                <td>{{ app.id }}</td>
                <td>{{ app.user}}</td>
                <td>{{ app.user.first_name }}&nbsp;{{ app.user.last_name }}</td>
                <td>
                    <div class="btn-group btn-group-sm d-inline-flex justify-content-around">
                        <button type="button" onclick="changeStatus(event)" id="ip-{{app.id}}" data-id="{{ app.id }}" data-success="btn-info" class="btn {% ifequal app.status 'In Process' %} btn-info {% else %} btn-dark
                        {% endifequal %}">In Process</button>
                        <button type="button" onclick="changeStatus(event)" id="h-{{app.id}}" data-id="{{ app.id }}" data-success="btn-success"class="btn {% ifequal app.status 'Hired' %} btn-success {% else %} btn-dark
                        {% endifequal %}">Hired</button>
                        <button type="button" onclick="changeStatus(event)" id="r-{{app.id}}" data-id="{{ app.id }}" data-success="btn-danger" class="btn {% ifequal app.status 'Rejected' %} btn-danger {% else %} btn-dark
                        {% endifequal %}">Rejected</button>
                      </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script>
    async function changeStatus(event){
        // const response = await fetch("/custom-admin/applications/change-status", {method="post"});
        const allButtons = document.querySelectorAll(`[data-id='${event.target.dataset.id}']`);
        for(let i = 0; i < allButtons.length; i++){
            if(allButtons[i].id != event.target.id){
                allButtons[i].classList.remove(allButtons[i].dataset.success);
                allButtons[i].classList.add("btn-dark");
            }
        }
        event.target.classList.add(event.target.dataset.success);  
        event.target.classList.remove("btn-dark");  
    }
</script>
</div>

{% endblock content %}